<html>
<head>
  <link rel="stylesheet" href="../../css/spectre.min.css">
</head>

<body>
  <h1>Bangle.js RdongAM Test</h1>
  <button class="btn btn-primary" onclick="gather()">Gather Data</button>
  <pre id="output">Waiting...</pre>

  <script src="https://banglejs.com/apps/loader.js"></script>
  <script src="../../core/lib/customize.js"></script>
  <script>
    let outputEl = document.getElementById("output");

    function gather() {
      outputEl.textContent = 'üîå Connecting via App Loader...';
      Bangle.connect().then(() => {
        outputEl.textContent += '\n‚úÖ Connected. Sending code to RAM...';
        const code = 'NRF.println(JSON.stringify({value:"ARRRf"}));';
        return Bangle.write('EVAL', code);
      }).then(() => {
        outputEl.textContent += '\nüì§ Code sent! Waiting for response...';
        // Listen for the response you printed
        Bangle.on('msg', function handler(d) {
          outputEl.textContent += '\nüì° From Bangle: ' + d;
          Bangle.removeListener('msg', handler);
        });
      }).catch(err => {
        outputEl.textContent = '‚ùó Error: ' + err;
      });
    }
  </script>
</body>
</html>
